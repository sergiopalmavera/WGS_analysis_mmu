library(plotly)
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95_PASS.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>%
mutate(SAMPLE_ALIAS = str_remove(SAMPLE_ALIAS, "-L1")) %>%
left_join(sample_info, by = c("SAMPLE_ALIAS" = "sample_id")) %>%
mutate(Linie = factor(Linie, levels = c("DUK","DUC","DU6","DU6P","DUhLB","FZTDU"))) %>%
arrange(Linie, target_cvg, SAMPLE_ALIAS)
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/ohort_biallelicSNPs_VQSR95.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>%
mutate(SAMPLE_ALIAS = str_remove(SAMPLE_ALIAS, "-L1")) %>%
left_join(sample_info, by = c("SAMPLE_ALIAS" = "sample_id")) %>%
mutate(Linie = factor(Linie, levels = c("DUK","DUC","DU6","DU6P","DUhLB","FZTDU"))) %>%
arrange(Linie, target_cvg, SAMPLE_ALIAS)
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>%
mutate(SAMPLE_ALIAS = str_remove(SAMPLE_ALIAS, "-L1")) %>%
left_join(sample_info, by = c("SAMPLE_ALIAS" = "sample_id")) %>%
mutate(Linie = factor(Linie, levels = c("DUK","DUC","DU6","DU6P","DUhLB","FZTDU"))) %>%
arrange(Linie, target_cvg, SAMPLE_ALIAS)
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",")
mid_vcf_metrics_summary
final_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95_PASS_AddedMissingness.recode.filtered.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",")
final_vcf_metrics_summary
mid_vcf_metrics_summary
raw_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",")
raw_vcf_metrics_summary
mid_vcf_metrics_summary
raw_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>% mutate(data_set = "raw")
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>% mutate(data_set = "site_filtered")
final_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95_PASS_AddedMissingness.recode.filtered.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>%
mutate(data_set = "gt_filtered")
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
raw_vcf_metrics_summary
)
raw_vcf_metrics_summary
raw_vcf_metrics_summary
mid_vcf_metrics_summary
raw_vcf_metrics_summary
names(raw_vcf_metrics_summary)
names(mid_vcf_metrics_summary)
names(final_vcf_metrics_summary)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
)
raw_vcf_metrics_summary
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
#final_vcf_metrics_summary
)
raw_vcf_metrics_summary$PCT_DBSNP_INDELS
raw_vcf_metrics_summary$PCT_DBSNP_INDELS %>% class()
mid_vcf_metrics_summary$PCT_DBSNP_INDELS %>% class()
final_vcf_metrics_summary$PCT_DBSNP_INDELS
mid_vcf_metrics_summary$PCT_DBSNP_INDELS
final_vcf_metrics_summary
raw_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>% mutate(data_set = "raw")
mid_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>% mutate(data_set = "site_filtered") %>%
mutate(PCT_DBSNP_INDELS = NA)
final_vcf_metrics_summary <- read.delim(here("batches123_04_FinalVCF/metrics/cohort_biallelicSNPs_VQSR95_PASS_AddedMissingness.recode.filtered.table.variant_calling_summary_metrics"), stringsAsFactors = F, comment.char = "#", dec = ",") %>%
mutate(data_set = "gt_filtered") %>%
mutate(PCT_DBSNP_INDELS = NA)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, everything())
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt()
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(measure.vars = c("raw","site_filtered","gt_filtered"))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(measure.vars = "data_set")
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
dcast(. ~ data_set)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>% names()
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
dcast(names(.)[2:9] ~ data_set)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt()
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = data_Set)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = data_set)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set")
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value")
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
kable()
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable()
vcfs_main_summary
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(digits = 3)
vcfs_main_summary
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.marks = ","))
vcfs_main_summary
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.marks = ","))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.mark = ","))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>% apply(2,class)
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
apply(.[,2:4],2,function(x) as.numeric(x)) %>%
knitr::kable(format.args = list(big.mark = ","))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
apply(2,function(x) as.numeric(x)) %>%
knitr::kable(format.args = list(big.mark = ","))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.mark = ","))
bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set")
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary
vcfs_main_summary$raw %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") #%>%
#dcast(variable ~ data_set, fill = "value") %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$raw %>% class()
vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") #%>%
dcast(variable ~ data_set, fill = "value") %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$raw %>% class()
vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$raw %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$raw %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$raw %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value")# %>%
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$raw %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
vcfs_main_summary$gt_filtered %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered))
#dplyr::select(variable, raw, site_filtered, gt_filtered)# %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
#knitr::kable(format.args = list(big.mark = ","))
vcfs_main_summary$gt_filtered %>% class()
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) #%>%
#dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
#knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) #%>%
#knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
options(scipen = 999)
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.mark = ","))
#vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
vcfs_main_summary <- bind_rows(
raw_vcf_metrics_summary,
mid_vcf_metrics_summary,
final_vcf_metrics_summary
) %>%
dplyr::select(data_set, TOTAL_SNPS, NUM_IN_DB_SNP, NOVEL_SNPS, PCT_DBSNP, DBSNP_TITV, NOVEL_TITV, TOTAL_INDELS, TOTAL_MULTIALLELIC_SNPS) %>%
melt(id.vars = "data_set") %>%
dcast(variable ~ data_set, fill = "value") %>%
mutate(raw = as.numeric(raw),
site_filtered = as.numeric(site_filtered),
gt_filtered = as.numeric(gt_filtered)) %>%
dplyr::select(variable, raw, site_filtered, gt_filtered) %>%
knitr::kable(format.args = list(big.mark = ","), digits = 2)
#vcfs_main_summary$gt_filtered %>% class()
#vcfs_main_summary$value %>% class()
vcfs_main_summary
