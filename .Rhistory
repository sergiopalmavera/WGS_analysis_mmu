ungroup() %>%
filter(contrast == tst$contrast[i] & z_win_fst_score >= tst$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = tst$contrast[i])
rm(tst)
zfst_q <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99)
)
i = 1
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
})
lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
}) %>%
bind_rows()
zfst_q <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99)
)
lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
zfst_q99 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q99 = quantile(z_win_fst_score, 0.99)
)
fst_q99 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
fst_q99
zfst_q95 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95)
)
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q$contrast[i] & z_win_fst_score >= zfst_q$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
fst_q95
zfst_q99 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q99 = quantile(z_win_fst_score, 0.99)
)
fst_q99 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q99$contrast[i] & z_win_fst_score >= zfst_q99$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q99$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
zfst_q95 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95)
)
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q95$contrast[i] & z_win_fst_score >= zfst_q95$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q95$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
zfst_q99 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q99 = quantile(z_win_fst_score, 0.99)
)
zfst_q99
fst_q99 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q99$contrast[i] & z_win_fst_score >= zfst_q99$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q99$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
fst_q99
zfst_q95 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95)
)
zfst_q95
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q95$contrast[i] & z_win_fst_score >= zfst_q95$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q95$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q95$contrast[i] & z_win_fst_score >= zfst_q95$q95[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q95$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
fst_q95
zfst_q99 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q99 = quantile(z_win_fst_score, 0.99)
)
fst_q99 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q99$contrast[i] & z_win_fst_score >= zfst_q99$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q99$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
zfst_q95 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95)
)
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q95$contrast[i] & z_win_fst_score >= zfst_q95$q95[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q95$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min)
zfst_q99 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q99 = quantile(z_win_fst_score, 0.99)
)
fst_q99 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q99$contrast[i] & z_win_fst_score >= zfst_q99$q99[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q99$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min) %>%
mutate(th_quantile = 99)
zfst_q95 <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
q95 = quantile(z_win_fst_score, 0.95)
)
fst_q95 <- lapply(1:5, function(i){
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
filter(contrast == zfst_q95$contrast[i] & z_win_fst_score >= zfst_q95$q95[i]) %>%
summarise(min = min(MEAN_FST)) %>%
mutate(contrast = zfst_q95$contrast[i])
}) %>%
bind_rows() %>%
dplyr::select(contrast, min) %>%
mutate(th_quantile = 95)
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2)
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast, is_x) %>%
summarise(
n_win = n(),
min = min(MEAN_FST),
median = median(MEAN_FST),
mean = mean(MEAN_FST),
q95 = quantile(MEAN_FST, 0.95),
q99 = quantile(MEAN_FST, 0.99),
max = max(MEAN_FST)
) %>%
arrange(is_x) %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x) %>%
kable(digits = 2)
summary_win_fst <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast, is_x) %>%
summarise(
n_win = n(),
min = min(MEAN_FST),
median = median(MEAN_FST),
mean = mean(MEAN_FST),
q95 = quantile(MEAN_FST, 0.95),
q99 = quantile(MEAN_FST, 0.99),
max = max(MEAN_FST)
) %>%
arrange(is_x) %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x) %>%
summary_win_fst  %>% kable(digits = 2)
summary_win_fst <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast, is_x) %>%
summarise(
n_win = n(),
min = min(MEAN_FST),
median = median(MEAN_FST),
mean = mean(MEAN_FST),
q95 = quantile(MEAN_FST, 0.95),
q99 = quantile(MEAN_FST, 0.99),
max = max(MEAN_FST)
) %>%
arrange(is_x) %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x) %>%
summary_win_fst  %>% kable(digits = 2)
summary_win_fst <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast, is_x) %>%
summarise(
n_win = n(),
min = min(MEAN_FST),
median = median(MEAN_FST),
mean = mean(MEAN_FST),
q95 = quantile(MEAN_FST, 0.95),
q99 = quantile(MEAN_FST, 0.99),
max = max(MEAN_FST)
) %>%
arrange(is_x) %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x)
summary_win_fst  %>% kable(digits = 2)
summary_win_fst
summary_win_fst <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast, is_x) %>%
summarise(
n_win = n(),
min = min(MEAN_FST),
median = median(MEAN_FST),
mean = mean(MEAN_FST),
q95 = quantile(MEAN_FST, 0.95),
q99 = quantile(MEAN_FST, 0.99),
max = max(MEAN_FST)
) %>%
arrange(is_x)
summary_win_fst %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x) %>%
kable(digits = 2)
summary_win_fst
p1 <- win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = MEAN_FST)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("Mean Window Fst")
p2 <- win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = NA, y = MEAN_FST)) +
geom_boxplot(width = 0.2) +
coord_flip() +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
theme(
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("Mean Window Fst")
gridExtra::grid.arrange(p1,p2, nrow = 1)
summary_win_fst %>%
mutate(is_x = ifelse(is_x, "X", "Autosome")) %>%
dplyr::rename( chr_type = is_x) %>%
kable(digits = 2)
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2, caption = "caption")
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2, caption = "pene")
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2,label = "pene")
knitr::kable(head(mtcars[, 1:3]),
caption = "This is the table caption")
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2, caption = "test")
win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
) %>%
kable(digits = 2, caption = "z(Mean Window Fst)")
summary_z_win_fst <- win_fst_sel_vs_ctrl_prep %>%
ungroup() %>%
group_by(contrast) %>%
summarise(
n_win = n(),
min = min(z_win_fst_score),
median = median(z_win_fst_score),
mean = mean(z_win_fst_score),
q95 = quantile(z_win_fst_score, 0.95),
q99 = quantile(z_win_fst_score, 0.99),
max = max(z_win_fst_score)
)
summary_z_win_fst %>% kable(digits = 2, caption = "z(Mean Window Fst)")
summary_z_win_fst
q <- summary_z_win_fst %>%
reshape2::melt(id.vars = c("contrast"), measure.vars = c("q95","q99"))
q
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = MEAN_FST)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("Mean Window Fst") +
geom_vline(summary_z_win_fst, aes(xintercept = value, color = variable))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = MEAN_FST)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("Mean Window Fst") +
geom_vline(summary_z_win_fst, mapping = aes(xintercept = value, color = variable))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = MEAN_FST)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("Mean Window Fst") +
geom_vline(summary_z_win_fst, mapping = aes(xintercept = value))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = MEAN_FST)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("Mean Window Fst") +
geom_vline(q, mapping = aes(xintercept = value))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = z_win_fst_score)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = value))
q
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = z_win_fst_score)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = value, color = variable))
q <- summary_z_win_fst %>%
reshape2::melt(id.vars = c("contrast"), measure.vars = c("q95","q99"), variable.name = "quantile", value.name = "zFst")
q
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = z_win_fst_score)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = zFst, color = quantile))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = z_win_fst_score)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = zFst, fill = quantile))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = z_win_fst_score)) +
geom_histogram(bins = 50) +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
xlab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = zFst, color = quantile))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = NA, y = z_win_fst_score)) +
geom_boxplot(width = 0.2) +
coord_flip() +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
theme(
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("z(Mean Window Fst)") +
geom_vline(q, mapping = aes(xintercept = zFst, color = quantile))
win_fst_sel_vs_ctrl_prep %>%
ggplot(aes(x = NA, y = z_win_fst_score)) +
geom_boxplot(width = 0.2) +
coord_flip() +
facet_wrap(~contrast, ncol = 1, strip.position = "right") +
theme_bw() +
theme(
axis.text.y = element_blank(),
axis.title.y = element_blank(),
axis.ticks.y = element_blank()
) +
ylab("z(Mean Window Fst)") +
geom_hline(q, mapping = aes(yintercept = zFst, color = quantile))
